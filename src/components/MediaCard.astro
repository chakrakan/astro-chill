---
import type { CollectionEntry } from "astro:content";

type Props = {
    entry: CollectionEntry<"favorites">;
};

const { entry } = Astro.props;
const { title, description, rating, image, category } = entry.data;

const getCategoryEmoji = (cat: string) => {
    switch (cat) {
        case "movies":
            return "ðŸŽ¬";
        case "tv":
            return "ðŸ“º";
        default:
            return "ðŸŽ­";
    }
};

const renderStars = (rating?: number) => {
    if (!rating) return null;
    return "â˜…".repeat(rating) + "â˜†".repeat(5 - rating);
};
---

<a
    href={`/favorites/${entry.slug}`}
    class="group relative flex flex-col overflow-hidden rounded-xl border border-black/10 bg-gradient-to-br from-neutral-50 to-neutral-100 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl dark:border-white/10 dark:from-neutral-900 dark:to-neutral-800"
>
    <!-- Poster/Image Area -->
    <div
        class="relative aspect-[2/3] w-full overflow-hidden bg-gradient-to-br from-purple-500/20 to-pink-500/20 dark:from-purple-500/10 dark:to-pink-500/10"
    >
        {
            image ? (
                <img
                    src={image}
                    alt={title}
                    class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                />
            ) : (
                <div class="flex h-full w-full items-center justify-center text-6xl opacity-60">
                    {getCategoryEmoji(category)}
                </div>
            )
        }

        <!-- Spoiler Badge -->
        <div
            class="absolute right-2 top-2 rounded-full bg-red-500/90 px-2 py-0.5 text-xs font-medium text-white backdrop-blur-sm"
        >
            Contains Spoilers
        </div>

        <!-- Rating Overlay -->
        {
            rating && (
                <div class="absolute bottom-2 left-2 rounded-md bg-black/70 px-2 py-1 text-sm text-yellow-400 backdrop-blur-sm">
                    {renderStars(rating)}
                </div>
            )
        }
    </div>

    <!-- Content Area -->
    <div class="flex flex-1 flex-col gap-1 p-4">
        <h3 class="line-clamp-2 font-semibold text-black dark:text-white">
            {title}
        </h3>
        <p class="line-clamp-2 text-sm text-black/60 dark:text-white/60">
            {description}
        </p>
    </div>

    <!-- Hover Indicator -->
    <div
        class="absolute inset-x-0 bottom-0 h-1 origin-left scale-x-0 bg-gradient-to-r from-purple-500 to-pink-500 transition-transform duration-300 group-hover:scale-x-100"
    >
    </div>
</a>
